<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="org.sunw.self.admin.user.manager.mapper.ManageManagerMapper">
	
	<!-- 새로운 회원 메니져 등록 -->
	<insert id="managerInsert">
		<selectKey order="AFTER" resultType="int">
			SELECT INSERT_ID()
		</selectKey>
		INSERT INTO medical_appointment.ad_user
		(
		USER_ID, 
		PASSWORD, 
		NAME, 
		BIRTH, 
		SEX, 
		PHONE_NUMBER, 
		AUTH
		)
		VALUES
		(
		#{userId},
		#{password},
		#{name},
		#{birth},
		#{sex},
		#{phoneNumber},
		#{auth}
		)
	</insert>


	<!-- 이름에 대한 검색결과 NAME이 NULL이아닐경우 값을 NAME에대한 값을 가져옴  -->
	<select id="getAllManagerList"
	resultType="org.sunw.self.admin.user.user.domain.ManageUserVO"
	parameterType="org.sunw.self.admin.user.user.domain.ManageUserDTO">
	SELECT USER_ID,
		PASSWORD, 
		NAME, 
		BIRTH, 
		SEX, 
		PHONE_NUMBER, 
		AUTH
	FROM medical_appointment.ad_user
	<if test='name != null and name != "" '>
		WHERE NAME LIKE CONCAT('%',#{name},'%')
		</if>
	ORDER BY USER_ID DESC
	LIMIT #{skip},
		#{perSheet}
	</select>
	
	<!-- 회원 매니져 조회 -->
	<select id="getUserById"
	resultType="org.sunw.self.admin.user.user.domain.ManageUserVO">
	SELECT USER_ID,
		PASSWORD, 
		NAME, 
		BIRTH, 
		SEX, 
		PHONE_NUMBER, 
		AUTH
	FROM medical_appointment.ad_user
	WHERE USER_ID=#{userId}
	</select>

	<!-- 수정 -->
	<update id="managerUpdate">
		UPDATE medical_appointment.ad_user
		SET 
		PASSWORD			=#{password}, 
		NAME				=#{name}, 
		BIRTH				=#{birth}, 
		SEX					=#{sex}, 
		PHONE_NUMBER		=#{phoneNumber}, 
		AUTH				=#{auth}
		WHERE USER_ID		=#{userId}
	</update>

	
	<!-- 삭제 -->
	<delete id="managerDelete">
	DELETE FROM medical_appointment.ad_user
	WHERE USER_ID=#{userId}
	</delete>

	
	<select id="getManagerListCnt" resultType="int">
	SELECT COUNT(*)
	FROM medical_appointment.ad_user
	</select>

	
</mapper>